# 로컬 테스트 가이드

로컬 환경에서 찬양 콘티 서비스를 테스트하는 방법을 설명합니다.

## 📋 사전 준비

테스트하기 전에 다음이 준비되어 있어야 합니다:

- ✅ Supabase 프로젝트 생성 및 스키마 설정 완료
- ✅ Google Drive API 설정 완료
- ✅ `.env.local` 파일에 환경 변수 설정 완료

---

## 1. 환경 변수 확인

프로젝트 루트에 `.env.local` 파일이 있는지 확인하세요.

### .env.local 파일 예시

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Google Drive API
GOOGLE_DRIVE_CLIENT_EMAIL=drive-uploader@project-xxxxx.iam.gserviceaccount.com
GOOGLE_DRIVE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n실제_개인키_내용\n-----END PRIVATE KEY-----\n"
GOOGLE_DRIVE_FOLDER_ID=1a2b3c4d5e6f7g8h9i0j

# Next.js
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

⚠️ **중요**: `.env.local` 파일이 없다면 생성하고 위의 값들을 실제 값으로 채워넣으세요.

---

## 2. 개발 서버 실행

터미널에서 다음 명령어를 실행하세요:

```bash
npm run dev
```

서버가 시작되면 다음과 같은 메시지가 표시됩니다:

```
  ▲ Next.js 16.1.4
  - Local:        http://localhost:3000
  - Ready in 2.3s
```

---

## 3. 브라우저에서 접속

1. 브라우저를 열고 다음 주소로 접속:
   ```
   http://localhost:3000
   ```

2. 메인 페이지가 표시되면 성공입니다!

---

## 4. 기능 테스트

### 4-1. 악보 등록 테스트

1. 메인 페이지에서 **"악보 등록하기"** 클릭
2. 또는 상단 네비게이션에서 **"악보"** 클릭 → **"새 악보"** 클릭

3. **이미지 업로드 방법**:
   - 방법 1: 이미지 파일을 드래그 앤 드롭
   - 방법 2: 업로드 영역 클릭하여 파일 선택
   - 방법 3: 이미지를 클립보드에 복사한 후 `Ctrl+V` (Windows) / `Cmd+V` (Mac)

4. **정보 입력**:
   - 곡명: 예) "주 예수보다 귀한 것은 없네"
   - 아티스트: 예) "김명식"
   - Key: 예) "C"

5. **"등록"** 버튼 클릭

6. **확인**:
   - 성공 메시지 확인
   - 악보 목록 페이지로 이동
   - 등록한 악보가 표시되는지 확인

### 4-2. 콘티 등록 테스트

1. 메인 페이지에서 **"콘티 만들기"** 클릭
2. 또는 상단 네비게이션에서 **"콘티"** 클릭 → **"새 콘티"** 클릭

3. **기본 정보 입력**:
   - 예배 날짜: 달력에서 날짜 선택
   - 예배명: 예) "주일예배"

4. **"확인"** 버튼 클릭

5. **곡 추가**:
   - 검색창에 곡명, 아티스트, 또는 Key 입력
   - 검색 결과에서 원하는 곡 클릭하여 추가
   - 여러 곡을 추가할 수 있습니다

6. **곡 삭제**:
   - 곡 목록에서 **X** 버튼 클릭

7. **"저장"** 버튼 클릭

8. **확인**:
   - 성공 메시지 확인
   - 콘티 목록 페이지로 이동
   - 등록한 콘티가 표시되는지 확인

### 4-3. 콘티 공유 테스트

1. 콘티 목록 페이지에서 등록한 콘티의 **"보기"** 버튼 클릭
2. 또는 콘티 목록에서 **공유 아이콘** (📤) 클릭하여 링크 복사
3. **공유 링크 확인**:
   - URL 형식: `http://localhost:3000/setlists/[콘티ID]`
   - 이 링크를 다른 브라우저나 시크릿 모드에서 열어보세요
   - 읽기 전용으로 표시되는지 확인

### 4-4. 모바일 UI 테스트

1. 브라우저 개발자 도구 열기 (`F12` 또는 `Ctrl+Shift+I`)
2. 디바이스 툴바 토글 (`Ctrl+Shift+M` 또는 휴대폰 아이콘 클릭)
3. 모바일 기기 선택 (예: iPhone 12, Galaxy S20)
4. 콘티 공유 페이지가 모바일에서 잘 보이는지 확인

---

## 5. 데이터베이스 확인

### 5-1. Supabase에서 데이터 확인

1. [Supabase 대시보드](https://app.supabase.com) 접속
2. 프로젝트 선택
3. 왼쪽 사이드바에서 **"Table Editor"** 클릭
4. 다음 테이블들을 확인:
   - `songs`: 등록한 악보 데이터
   - `setlists`: 등록한 콘티 데이터
   - `setlist_songs`: 콘티와 곡의 연결 데이터

### 5-2. Google Drive에서 이미지 확인

1. [Google Drive](https://drive.google.com) 접속
2. 설정한 폴더 열기
3. 업로드한 악보 이미지 파일 확인

---

## 6. 문제 해결

### 문제 1: "Failed to fetch" 에러

**원인**: 환경 변수가 설정되지 않았거나 잘못됨

**해결**:
1. `.env.local` 파일이 존재하는지 확인
2. 모든 환경 변수가 올바르게 설정되었는지 확인
3. 개발 서버 재시작 (`Ctrl+C` 후 `npm run dev`)

### 문제 2: 이미지 업로드 실패

**원인**: Google Drive API 설정 오류

**해결**:
1. `.env.local`의 `GOOGLE_DRIVE_PRIVATE_KEY`가 따옴표로 감싸져 있는지 확인
2. 서비스 계정에 폴더 공유 권한이 있는지 확인
3. 브라우저 콘솔에서 에러 메시지 확인

### 문제 3: 데이터베이스 연결 실패

**원인**: Supabase URL 또는 Key 오류

**해결**:
1. `.env.local`의 Supabase URL과 Key 확인
2. Supabase 대시보드에서 값 재확인
3. 개발 서버 재시작

### 문제 4: 포트 3000이 이미 사용 중

**원인**: 다른 프로세스가 포트 3000을 사용 중

**해결**:
```bash
# Windows에서 포트 사용 중인 프로세스 확인
netstat -ano | findstr :3000

# 또는 다른 포트 사용
npm run dev -- -p 3001
```

---

## 7. 개발 팁

### 7-1. 핫 리로드

코드를 수정하면 자동으로 페이지가 새로고침됩니다.

### 7-2. 브라우저 콘솔 확인

개발자 도구 (`F12`) → Console 탭에서 에러 메시지 확인

### 7-3. 네트워크 탭 확인

개발자 도구 → Network 탭에서 API 요청 상태 확인

### 7-4. 빌드 테스트

배포 전에 빌드가 성공하는지 확인:

```bash
npm run build
```

---

## 8. 테스트 체크리스트

로컬 테스트 시 확인할 사항:

- [ ] 메인 페이지가 정상적으로 표시됨
- [ ] 악보 등록 기능 작동
- [ ] 이미지 업로드/붙여넣기 작동
- [ ] 악보 목록 표시
- [ ] 콘티 등록 기능 작동
- [ ] 곡 검색 기능 작동
- [ ] 곡 추가/삭제 기능 작동
- [ ] 콘티 목록 표시
- [ ] 콘티 상세 페이지 표시
- [ ] 공유 링크 작동
- [ ] 모바일 UI 정상 표시
- [ ] Supabase에 데이터 저장됨
- [ ] Google Drive에 이미지 업로드됨

---

## 9. 다음 단계

로컬 테스트가 완료되면:

1. ✅ 모든 기능이 정상 작동하는지 확인
2. ✅ GitHub에 프로젝트 푸시
3. ✅ Vercel에 배포

---

## 💡 유용한 명령어

```bash
# 개발 서버 실행
npm run dev

# 프로덕션 빌드
npm run build

# 프로덕션 서버 실행
npm run start

# 린트 검사
npm run lint
```

---

## 🎉 완료!

로컬 테스트가 성공적으로 완료되면 배포 준비가 완료된 것입니다!

문제가 발생하면 브라우저 콘솔과 터미널의 에러 메시지를 확인하세요.
