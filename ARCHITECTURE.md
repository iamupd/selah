# ν”„λ΅μ νΈ μ•„ν‚¤ν…μ² μ„¤λ…

## Next.js ν’€μ¤νƒ κµ¬μ΅°

μ΄ ν”„λ΅μ νΈλ” **Next.js 14 (App Router)**λ¥Ό μ‚¬μ©ν•λ©°, λ³„λ„μ λ°±μ—”λ“ μ„λ²„κ°€ ν•„μ” μ—†μµλ‹λ‹¤.

### μ™ λ°±μ—”λ“ μ„λ²„κ°€ ν•„μ” μ—†λ‚μ”?

Next.jsλ” **ν’€μ¤νƒ ν”„λ μ„μ›ν¬**μ…λ‹λ‹¤:
- β… ν”„λ΅ νΈμ—”λ“ (React μ»΄ν¬λ„νΈ)
- β… λ°±μ—”λ“ (API Routes)
- β… ν•λ‚μ λ…λ Ήμ–΄λ΅ λ¨λ‘ μ‹¤ν–‰

---

## ν”„λ΅μ νΈ κµ¬μ΅°

```
ν”„λ΅μ νΈ/
β”β”€β”€ app/
β”‚   β”β”€β”€ api/              β† λ°±μ—”λ“ API (μ„λ²„ μ‚¬μ΄λ“)
β”‚   β”‚   β”β”€β”€ songs/
β”‚   β”‚   β”‚   β”β”€β”€ route.ts          # GET, POST /api/songs
β”‚   β”‚   β”‚   β””β”€β”€ upload/
β”‚   β”‚   β”‚       β””β”€β”€ route.ts      # POST /api/songs/upload
β”‚   β”‚   β””β”€β”€ setlists/
β”‚   β”‚       β”β”€β”€ route.ts          # GET, POST /api/setlists
β”‚   β”‚       β””β”€β”€ [id]/
β”‚   β”‚           β””β”€β”€ route.ts      # GET /api/setlists/[id]
β”‚   β”‚
β”‚   β”β”€β”€ songs/            β† ν”„λ΅ νΈμ—”λ“ νμ΄μ§€ (ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“)
β”‚   β”‚   β”β”€β”€ page.tsx
β”‚   β”‚   β””β”€β”€ new/
β”‚   β”‚       β””β”€β”€ page.tsx
β”‚   β”‚
β”‚   β””β”€β”€ setlists/         β† ν”„λ΅ νΈμ—”λ“ νμ΄μ§€ (ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“)
β”‚       β”β”€β”€ page.tsx
β”‚       β”β”€β”€ new/
β”‚       β”‚   β””β”€β”€ page.tsx
β”‚       β””β”€β”€ [id]/
β”‚           β””β”€β”€ page.tsx
β”‚
β””β”€β”€ lib/                  β† κ³µν†µ μ ν‹Έλ¦¬ν‹°
    β”β”€β”€ supabase/
    β”‚   β”β”€β”€ server.ts     # μ„λ²„ μ‚¬μ΄λ“ Supabase ν΄λΌμ΄μ–ΈνΈ
    β”‚   β””β”€β”€ client.ts     # ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ Supabase ν΄λΌμ΄μ–ΈνΈ
    β””β”€β”€ google-drive.ts   # Google Drive API ν•¨μ
```

---

## μ‹¤ν–‰ λ°©λ²•

### κ°λ° λ¨λ“ (ν”„λ΅ νΈμ—”λ“ + λ°±μ—”λ“ ν•¨κ» μ‹¤ν–‰)

```bash
npm run dev
```

μ΄ λ…λ Ήμ–΄ ν•λ‚λ΅:
- β… ν”„λ΅ νΈμ—”λ“ μ„λ²„ μ‹¤ν–‰ (ν¬νΈ 3000)
- β… λ°±μ—”λ“ API μ„λ²„ μ‹¤ν–‰ (κ°™μ€ ν¬νΈ 3000)
- β… ν•« λ¦¬λ΅λ“ ν™μ„±ν™”

### ν”„λ΅λ•μ… λΉλ“

```bash
# λΉλ“
npm run build

# ν”„λ΅λ•μ… μ„λ²„ μ‹¤ν–‰
npm run start
```

---

## API Routes (λ°±μ—”λ“)

### 1. μ•…λ³΄ API

**νμΌ**: `app/api/songs/route.ts`

- **GET** `/api/songs` - μ•…λ³΄ λ©λ΅ μ΅°ν
- **GET** `/api/songs?q=κ²€μƒ‰μ–΄` - μ•…λ³΄ κ²€μƒ‰
- **POST** `/api/songs` - μƒ μ•…λ³΄ λ“±λ΅

### 2. μ΄λ―Έμ§€ μ—…λ΅λ“ API

**νμΌ**: `app/api/songs/upload/route.ts`

- **POST** `/api/songs/upload` - μ΄λ―Έμ§€λ¥Ό Google Driveμ— μ—…λ΅λ“

### 3. μ½ν‹° API

**νμΌ**: `app/api/setlists/route.ts`

- **GET** `/api/setlists` - μ½ν‹° λ©λ΅ μ΅°ν
- **POST** `/api/setlists` - μƒ μ½ν‹° λ“±λ΅

### 4. μ½ν‹° μƒμ„Έ API

**νμΌ**: `app/api/setlists/[id]/route.ts`

- **GET** `/api/setlists/[id]` - νΉμ • μ½ν‹° μƒμ„Έ μ΅°ν

---

## μ„λ²„ μ‚¬μ΄λ“ vs ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“

### μ„λ²„ μ‚¬μ΄λ“ (λ°±μ—”λ“)

`app/api/` ν΄λ”μ νμΌλ“¤μ€ **μ„λ²„μ—μ„λ§ μ‹¤ν–‰**λ©λ‹λ‹¤:

```typescript
// app/api/songs/route.ts
export async function GET(request: Request) {
  // μ΄ μ½”λ“λ” μ„λ²„μ—μ„λ§ μ‹¤ν–‰λ¨
  const supabase = await createClient() // μ„λ²„ μ‚¬μ΄λ“ ν΄λΌμ΄μ–ΈνΈ
  // ...
}
```

**νΉμ§•**:
- β… ν™κ²½ λ³€μμ— μ§μ ‘ μ ‘κ·Ό κ°€λ¥
- β… λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°
- β… μ™Έλ¶€ API νΈμ¶ (Google Drive λ“±)
- β… λ―Όκ°ν• μ •λ³΄ μ²λ¦¬

### ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ (ν”„λ΅ νΈμ—”λ“)

`app/songs/`, `app/setlists/` ν΄λ”μ νμΌλ“¤μ€ **λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰**λ©λ‹λ‹¤:

```typescript
// app/songs/new/page.tsx
'use client' // ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ

export default function NewSongPage() {
  // μ΄ μ½”λ“λ” λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λ¨
  const response = await fetch('/api/songs', { ... })
  // ...
}
```

**νΉμ§•**:
- β… μ‚¬μ©μ μΈν„°λ™μ… μ²λ¦¬
- β… μƒνƒ κ΄€λ¦¬ (useState, useEffect λ“±)
- β… API νΈμ¶ (fetch)

---

## λ°μ΄ν„° νλ¦„

```
λΈλΌμ°μ € (ν΄λΌμ΄μ–ΈνΈ)
    β†“ fetch('/api/songs')
Next.js μ„λ²„ (API Route)
    β†“ Supabase ν΄λΌμ΄μ–ΈνΈ
Supabase λ°μ΄ν„°λ² μ΄μ¤
    β†“ μ‘λ‹µ
Next.js μ„λ²„
    β†“ JSON μ‘λ‹µ
λΈλΌμ°μ €
```

---

## μ™Έλ¶€ μ„λΉ„μ¤ μ—°λ™

### Supabase (λ°μ΄ν„°λ² μ΄μ¤)

- **μ„λ²„ μ‚¬μ΄λ“**: `lib/supabase/server.ts`
- **ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“**: `lib/supabase/client.ts` (ν„μ¬ λ―Έμ‚¬μ©)

### Google Drive (μ΄λ―Έμ§€ μ¤ν† λ¦¬μ§€)

- **μ„λ²„ μ‚¬μ΄λ“λ§**: `lib/google-drive.ts`
- API Routeμ—μ„λ§ νΈμ¶: `app/api/songs/upload/route.ts`

---

## μ”μ•½

### β… μ‹¤ν–‰ν•  κ²ƒ

```bash
npm run dev
```

μ΄κ²ƒλ§ μ‹¤ν–‰ν•λ©΄ λ©λ‹λ‹¤!

### β μ‹¤ν–‰ν•  ν•„μ” μ—†λ” κ²ƒ

- λ³„λ„μ Express μ„λ²„
- λ³„λ„μ Node.js λ°±μ—”λ“ μ„λ²„
- λ³„λ„μ API μ„λ²„

### π― ν•µμ‹¬ ν¬μΈνΈ

1. **Next.js = ν”„λ΅ νΈμ—”λ“ + λ°±μ—”λ“**
2. **`app/api/` = λ°±μ—”λ“ API**
3. **`npm run dev` = λ¨λ“  κ²ƒ μ‹¤ν–‰**

---

## Vercel λ°°ν¬ μ‹

Vercelμ— λ°°ν¬ν•λ©΄:
- β… API Routesκ°€ μλ™μΌλ΅ μ„λ²„λ¦¬μ¤ ν•¨μλ΅ λ³€ν™λ¨
- β… λ³„λ„ μ„λ²„ κ΄€λ¦¬ λ¶ν•„μ”
- β… μλ™ μ¤μΌ€μΌλ§

---

## μ§λ¬Έκ³Ό λ‹µλ³€

### Q: Express μ„λ²„λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ‚μ”?
**A**: μ•„λ‹μ”. Next.js API Routesκ°€ λ°±μ—”λ“ μ—­ν• μ„ ν•©λ‹λ‹¤.

### Q: λ°±μ—”λ“ μ„λ²„λ¥Ό λ³„λ„λ΅ μ‹¤ν–‰ν•΄μ•Ό ν•λ‚μ”?
**A**: μ•„λ‹μ”. `npm run dev` ν•λ‚λ΅ λ¨λ‘ μ‹¤ν–‰λ©λ‹λ‹¤.

### Q: APIλ” μ–΄λ””μ— μλ‚μ”?
**A**: `app/api/` ν΄λ”μ— μμµλ‹λ‹¤.

### Q: μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ¥Ό κµ¬λ¶„ν•λ” λ°©λ²•μ€?
**A**: 
- `app/api/` = μ„λ²„ (λ°±μ—”λ“)
- `app/songs/`, `app/setlists/` = ν΄λΌμ΄μ–ΈνΈ (ν”„λ΅ νΈμ—”λ“)

---

## π‰ κ²°λ΅ 

**λ³„λ„μ λ°±μ—”λ“ μ„λ²„λ” ν•„μ” μ—†μµλ‹λ‹¤!**

`npm run dev` λ…λ Ήμ–΄ ν•λ‚λ΅ ν”„λ΅ νΈμ—”λ“μ™€ λ°±μ—”λ“κ°€ λ¨λ‘ μ‹¤ν–‰λ©λ‹λ‹¤.
